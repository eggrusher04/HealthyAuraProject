{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useAuth}from'../contexts/AuthContext';import{mockApi}from'../services/mockApi';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Home(){const{user}=useAuth();const[recommend,setRecommend]=useState(null);const[dismissedToday,setDismissedToday]=useState(false);useEffect(()=>{// check localStorage for dismissed popup today\nconst d=localStorage.getItem('rec_dismiss_date');if(d===new Date().toDateString())setDismissedToday(true);if(user&&!dismissedToday){// fetch one recommendation candidate based on user preferences\nmockApi.getStalls({tags:user!==null&&user!==void 0&&user.diet?[user.diet]:[]}).then(r=>{if(r.stalls&&r.stalls.length)setRecommend(r.stalls[0]);});}},[user,dismissedToday]);const dismiss=()=>{localStorage.setItem('rec_dismiss_date',new Date().toDateString());setDismissedToday(true);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold mb-4\",children:\"Recommended for you\"}),user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 gap-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-white rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-lg font-medium\",children:\"Top picks near you\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Based on your preferences\"})]})}),recommend&&!dismissedToday&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 right-6 w-80 bg-white border p-4 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold\",children:recommend.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[recommend.center,\" \\u2022 \",recommend.price?\"Under $\".concat(recommend.price):'Unavailable']})]}),/*#__PURE__*/_jsx(\"button\",{onClick:dismiss,className:\"text-sm text-gray-500\",children:\"Dismiss\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 border rounded py-1 text-sm\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 bg-green-600 text-white rounded py-1 text-sm\",children:\"Get Directions\"})]})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-white rounded shadow\",children:\"Please sign in to see recommendations.\"})]});}","map":{"version":3,"names":["React","useEffect","useState","useAuth","mockApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","user","recommend","setRecommend","dismissedToday","setDismissedToday","d","localStorage","getItem","Date","toDateString","getStalls","tags","diet","then","r","stalls","length","dismiss","setItem","children","className","name","center","price","concat","onClick"],"sources":["D:/Documents/GitHub/2006-SCSD-16/Lab3/frontend/src/pages/Home.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { mockApi } from '../services/mockApi';\r\n\r\nexport default function Home(){\r\n  const { user } = useAuth();\r\n  const [recommend, setRecommend] = useState(null);\r\n  const [dismissedToday, setDismissedToday] = useState(false);\r\n\r\n  useEffect(()=>{\r\n    // check localStorage for dismissed popup today\r\n    const d = localStorage.getItem('rec_dismiss_date');\r\n    if (d === new Date().toDateString()) setDismissedToday(true);\r\n\r\n    if (user && !dismissedToday) {\r\n      // fetch one recommendation candidate based on user preferences\r\n      mockApi.getStalls({ tags: user?.diet ? [user.diet] : [] }).then(r => {\r\n        if (r.stalls && r.stalls.length) setRecommend(r.stalls[0]);\r\n      });\r\n    }\r\n  },[user,dismissedToday]);\r\n\r\n  const dismiss = () => {\r\n    localStorage.setItem('rec_dismiss_date', new Date().toDateString());\r\n    setDismissedToday(true);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-2xl font-semibold mb-4\">Recommended for you</h1>\r\n      {user ? (\r\n        <>\r\n          <div className=\"grid grid-cols-1 gap-3\">\r\n            {/* show a few cards (mock) */}\r\n            <div className=\"p-4 bg-white rounded-lg shadow\">\r\n              <div className=\"text-lg font-medium\">Top picks near you</div>\r\n              <div className=\"text-sm text-gray-500\">Based on your preferences</div>\r\n            </div>\r\n          </div>\r\n\r\n          {recommend && !dismissedToday && (\r\n            <div className=\"fixed bottom-6 right-6 w-80 bg-white border p-4 rounded-lg shadow-lg\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <div className=\"font-semibold\">{recommend.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">{recommend.center} â€¢ {recommend.price ? `Under $${recommend.price}` : 'Unavailable'}</div>\r\n                </div>\r\n                <button onClick={dismiss} className=\"text-sm text-gray-500\">Dismiss</button>\r\n              </div>\r\n              <div className=\"mt-3 flex gap-2\">\r\n                <button className=\"flex-1 border rounded py-1 text-sm\">View</button>\r\n                <button className=\"flex-1 bg-green-600 text-white rounded py-1 text-sm\">Get Directions</button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <div className=\"p-4 bg-white rounded shadow\">Please sign in to see recommendations.</div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}