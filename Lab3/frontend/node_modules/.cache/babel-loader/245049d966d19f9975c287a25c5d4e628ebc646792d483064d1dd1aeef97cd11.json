{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useAuth}from\"../contexts/AuthContext\";import API from\"../services/api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Rewards(){const{user}=useAuth();const[points,setPoints]=useState(0);const[rewards,setRewards]=useState([]);const[loading,setLoading]=useState(true);// Fetch user points\nconst fetchPoints=async()=>{try{const res=await API.get(\"/rewards/me\");setPoints(res.data.totalPoints||0);}catch(err){console.error(\"Error fetching user points:\",err);}};// Fetch rewards catalog\nconst fetchRewards=async()=>{try{const res=await API.get(\"/rewards/catalog\");setRewards(res.data||[]);}catch(err){console.error(\"Error fetching rewards catalog:\",err);}finally{setLoading(false);}};useEffect(()=>{if(user){fetchPoints();fetchRewards();}},[user]);// Redeem reward\nconst redeem=async rewardId=>{try{const res=await API.post(\"/rewards/me/redeem-reward/\".concat(rewardId));alert(res.data.message||\"Reward redeemed successfully!\");fetchPoints();// refresh balance\n}catch(err){console.error(\"Error redeeming reward:\",err);alert(\"Not enough points or reward unavailable.\");}};if(!user)return/*#__PURE__*/_jsx(\"div\",{children:\"Please sign in to view rewards.\"});if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-gray-500 mt-8\",children:\"Loading rewards...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded shadow mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Your Points Balance\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-700\",children:points})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-3\",children:rewards.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-gray-500\",children:\"No rewards available.\"}):rewards.map(r=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-4 rounded shadow flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-green-700\",children:r.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-600 mb-1\",children:r.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Cost: \",r.pointsRequired,\" pts \\u2022\",\" \",r.active?\"Active\":\"Inactive\"]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{disabled:points<r.pointsRequired,onClick:()=>redeem(r.id),className:\"px-3 py-1 rounded \".concat(points>=r.pointsRequired?\"bg-green-600 text-white hover:bg-green-700\":\"bg-gray-200 text-gray-500\"),children:\"Redeem\"})})]},r.id))})]});}","map":{"version":3,"names":["React","useEffect","useState","useAuth","API","jsx","_jsx","jsxs","_jsxs","Rewards","user","points","setPoints","rewards","setRewards","loading","setLoading","fetchPoints","res","get","data","totalPoints","err","console","error","fetchRewards","redeem","rewardId","post","concat","alert","message","children","className","length","map","r","name","description","pointsRequired","active","disabled","onClick","id"],"sources":["C:/Users/rusha/OneDrive/Documents/GitHub/2006-SCSD-16/Lab3/frontend/src/pages/Rewards.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\nimport API from \"../services/api\";\r\n\r\nexport default function Rewards() {\r\n  const { user } = useAuth();\r\n  const [points, setPoints] = useState(0);\r\n  const [rewards, setRewards] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Fetch user points\r\n  const fetchPoints = async () => {\r\n    try {\r\n      const res = await API.get(\"/rewards/me\");\r\n      setPoints(res.data.totalPoints || 0);\r\n    } catch (err) {\r\n      console.error(\"Error fetching user points:\", err);\r\n    }\r\n  };\r\n\r\n  // Fetch rewards catalog\r\n  const fetchRewards = async () => {\r\n    try {\r\n      const res = await API.get(\"/rewards/catalog\");\r\n      setRewards(res.data || []);\r\n    } catch (err) {\r\n      console.error(\"Error fetching rewards catalog:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      fetchPoints();\r\n      fetchRewards();\r\n    }\r\n  }, [user]);\r\n\r\n  // Redeem reward\r\n  const redeem = async (rewardId) => {\r\n    try {\r\n      const res = await API.post(`/rewards/me/redeem-reward/${rewardId}`);\r\n      alert(res.data.message || \"Reward redeemed successfully!\");\r\n      fetchPoints(); // refresh balance\r\n    } catch (err) {\r\n      console.error(\"Error redeeming reward:\", err);\r\n      alert(\"Not enough points or reward unavailable.\");\r\n    }\r\n  };\r\n\r\n  if (!user) return <div>Please sign in to view rewards.</div>;\r\n\r\n  if (loading)\r\n    return (\r\n      <div className=\"text-center text-gray-500 mt-8\">\r\n        Loading rewards...\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      {/* Points display */}\r\n      <div className=\"bg-white p-4 rounded shadow mb-4\">\r\n        <div className=\"text-sm text-gray-500\">Your Points Balance</div>\r\n        <div className=\"text-2xl font-bold text-green-700\">{points}</div>\r\n      </div>\r\n\r\n      {/* Rewards grid */}\r\n      <div className=\"grid gap-3\">\r\n        {rewards.length === 0 ? (\r\n          <div className=\"text-center text-gray-500\">No rewards available.</div>\r\n        ) : (\r\n          rewards.map((r) => (\r\n            <div\r\n              key={r.id}\r\n              className=\"bg-white p-4 rounded shadow flex justify-between items-center\"\r\n            >\r\n              <div>\r\n                <div className=\"font-semibold text-green-700\">{r.name}</div>\r\n                <div className=\"text-xs text-gray-600 mb-1\">\r\n                  {r.description}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">\r\n                  Cost: {r.pointsRequired} pts â€¢{\" \"}\r\n                  {r.active ? \"Active\" : \"Inactive\"}\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <button\r\n                  disabled={points < r.pointsRequired}\r\n                  onClick={() => redeem(r.id)}\r\n                  className={`px-3 py-1 rounded ${\r\n                    points >= r.pointsRequired\r\n                      ? \"bg-green-600 text-white hover:bg-green-700\"\r\n                      : \"bg-gray-200 text-gray-500\"\r\n                  }`}\r\n                >\r\n                  Redeem\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}