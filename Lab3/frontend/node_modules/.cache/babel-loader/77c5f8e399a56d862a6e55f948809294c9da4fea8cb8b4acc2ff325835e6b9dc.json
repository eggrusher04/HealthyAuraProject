{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useAuth}from'../contexts/AuthContext';import API from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Home(){var _recommend$tags;const{user}=useAuth();const[recommendations,setRecommendations]=useState([]);const[recommend,setRecommend]=useState(null);// Popup eatery\nuseEffect(()=>{if(user){const tags=user!==null&&user!==void 0&&user.diet?[user.diet]:[];const fetchRecommendations=async()=>{try{let response;if(tags.length>0){response=await API.get('/home/recommendations/tags',{params:{tags}});}else{response=await API.get('/home/recommendations');}if(response.data&&response.data.length>0){console.log('Fetched recommendations:',response.data);setRecommendations(response.data);setRecommend(response.data[0]);// popup always shows\n}}catch(err){console.error('Error fetching recommendations:',err);}};fetchRecommendations();}},[user]);const featured=recommendations.slice(0,10);const others=recommendations.slice(10);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold mb-4 text-green-800\",children:\"Recommended for you\"}),!user&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-white rounded shadow\",children:\"Please sign in to see recommendations.\"}),user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-green-700 mb-3\",children:\"Top Picks\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\",children:featured.map(rec=>{var _rec$tags;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-white rounded-lg shadow hover:shadow-md transition\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-green-700\",children:rec.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:rec.fullAddress||rec.address}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:rec.description}),((_rec$tags=rec.tags)===null||_rec$tags===void 0?void 0:_rec$tags.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex flex-wrap gap-1\",children:rec.tags.map((tag,i)=>/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\",children:tag},i))})]},rec.id);})}),others.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-green-700 mb-2\",children:\"More Eateries\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto whitespace-nowrap flex gap-3 p-2 border-t border-gray-200\",children:others.map(rec=>{var _rec$tags2;return/*#__PURE__*/_jsxs(\"div\",{className:\"inline-block w-72 bg-white rounded-lg shadow p-4 flex-shrink-0 hover:shadow-md transition\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-md font-semibold text-green-700 truncate\",children:rec.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 truncate\",children:rec.fullAddress||rec.address}),((_rec$tags2=rec.tags)===null||_rec$tags2===void 0?void 0:_rec$tags2.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex flex-wrap gap-1\",children:rec.tags.map((tag,i)=>/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\",children:tag},i))})]},rec.id);})})]}),recommend&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-6 right-6 w-80 bg-white border p-4 rounded-lg shadow-lg z-50 animate-slideUp\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-semibold text-green-800\",children:recommend.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:recommend.fullAddress||recommend.address}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-400 mt-1\",children:recommend.description}),((_recommend$tags=recommend.tags)===null||_recommend$tags===void 0?void 0:_recommend$tags.length)>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex flex-wrap gap-2\",children:recommend.tags.map((tag,i)=>/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\",children:tag},i))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setRecommend(null),className:\"text-sm text-gray-500\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 border rounded py-1 text-sm\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{className:\"flex-1 bg-green-600 text-white rounded py-1 text-sm\",children:\"Get Directions\"})]})]})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useAuth","API","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","_recommend$tags","user","recommendations","setRecommendations","recommend","setRecommend","tags","diet","fetchRecommendations","response","length","get","params","data","console","log","err","error","featured","slice","others","className","children","map","rec","_rec$tags","name","fullAddress","address","description","tag","i","id","_rec$tags2","onClick"],"sources":["C:/Users/rusha/OneDrive/Documents/GitHub/2006-SCSD-16/Lab3/frontend/src/pages/Home.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport API from '../services/api';\r\n\r\nexport default function Home() {\r\n  const { user } = useAuth();\r\n  const [recommendations, setRecommendations] = useState([]);\r\n  const [recommend, setRecommend] = useState(null); // Popup eatery\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      const tags = user?.diet ? [user.diet] : [];\r\n\r\n      const fetchRecommendations = async () => {\r\n        try {\r\n          let response;\r\n          if (tags.length > 0) {\r\n            response = await API.get('/home/recommendations/tags', { params: { tags } });\r\n          } else {\r\n            response = await API.get('/home/recommendations');\r\n          }\r\n\r\n          if (response.data && response.data.length > 0) {\r\n            console.log('Fetched recommendations:', response.data);\r\n            setRecommendations(response.data);\r\n            setRecommend(response.data[0]); // popup always shows\r\n          }\r\n        } catch (err) {\r\n          console.error('Error fetching recommendations:', err);\r\n        }\r\n      };\r\n\r\n      fetchRecommendations();\r\n    }\r\n  }, [user]);\r\n\r\n  const featured = recommendations.slice(0, 10);\r\n  const others = recommendations.slice(10);\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <h1 className=\"text-2xl font-semibold mb-4 text-green-800\">\r\n        Recommended for you\r\n      </h1>\r\n\r\n      {!user && (\r\n        <div className=\"p-4 bg-white rounded shadow\">\r\n          Please sign in to see recommendations.\r\n        </div>\r\n      )}\r\n\r\n      {user && (\r\n        <>\r\n          {/* Featured Top 10 */}\r\n          <h2 className=\"text-lg font-semibold text-green-700 mb-3\">\r\n            Top Picks\r\n          </h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\r\n            {featured.map((rec) => (\r\n              <div\r\n                key={rec.id}\r\n                className=\"p-4 bg-white rounded-lg shadow hover:shadow-md transition\"\r\n              >\r\n                <h3 className=\"text-lg font-semibold text-green-700\">{rec.name}</h3>\r\n                <p className=\"text-sm text-gray-600\">{rec.fullAddress || rec.address}</p>\r\n                <p className=\"text-xs text-gray-500 mt-1\">{rec.description}</p>\r\n                {rec.tags?.length > 0 && (\r\n                  <div className=\"mt-2 flex flex-wrap gap-1\">\r\n                    {rec.tags.map((tag, i) => (\r\n                      <span\r\n                        key={i}\r\n                        className=\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\"\r\n                      >\r\n                        {tag}\r\n                      </span>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Scrollable List for Remaining */}\r\n          {others.length > 0 && (\r\n            <>\r\n              <h2 className=\"text-lg font-semibold text-green-700 mb-2\">\r\n                More Eateries\r\n              </h2>\r\n              <div className=\"overflow-x-auto whitespace-nowrap flex gap-3 p-2 border-t border-gray-200\">\r\n                {others.map((rec) => (\r\n                  <div\r\n                    key={rec.id}\r\n                    className=\"inline-block w-72 bg-white rounded-lg shadow p-4 flex-shrink-0 hover:shadow-md transition\"\r\n                  >\r\n                    <h3 className=\"text-md font-semibold text-green-700 truncate\">\r\n                      {rec.name}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-500 truncate\">\r\n                      {rec.fullAddress || rec.address}\r\n                    </p>\r\n                    {rec.tags?.length > 0 && (\r\n                      <div className=\"mt-2 flex flex-wrap gap-1\">\r\n                        {rec.tags.map((tag, i) => (\r\n                          <span\r\n                            key={i}\r\n                            className=\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\"\r\n                          >\r\n                            {tag}\r\n                          </span>\r\n                        ))}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {/* Always-Visible Popup */}\r\n          {recommend && (\r\n            <div className=\"fixed bottom-6 right-6 w-80 bg-white border p-4 rounded-lg shadow-lg z-50 animate-slideUp\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <div>\r\n                  <div className=\"font-semibold text-green-800\">{recommend.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    {recommend.fullAddress || recommend.address}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-400 mt-1\">{recommend.description}</div>\r\n                  {recommend.tags?.length > 0 && (\r\n                    <div className=\"mt-2 flex flex-wrap gap-2\">\r\n                      {recommend.tags.map((tag, i) => (\r\n                        <span\r\n                          key={i}\r\n                          className=\"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full\"\r\n                        >\r\n                          {tag}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <button\r\n                  onClick={() => setRecommend(null)}\r\n                  className=\"text-sm text-gray-500\"\r\n                >\r\n                  âœ•\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"mt-3 flex gap-2\">\r\n                <button className=\"flex-1 border rounded py-1 text-sm\">View</button>\r\n                <button className=\"flex-1 bg-green-600 text-white rounded py-1 text-sm\">\r\n                  Get Directions\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}